<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="Terraform: Concepts and Getting Started"><meta property="og:site_name" content="Alfonz Jan Frithz Bakarbessy"><meta property="og:image" content><meta property="og:image:type" content="image/jpeg"><meta property="og:image:width" content><meta property="og:image:height" content><meta property="og:url" content="https://alfonzjanfrithz.github.io/post/terraform-concepts-and-getting-started/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2021-01-10"><meta property="article:modified_time" content="2021-01-10"><meta name=twitter:card content="summary"><meta name=twitter:site content="@alfonzjanfrithz"><meta name=twitter:creator content="@alfonzjanfrithz"><meta name=twitter:title content="Terraform: Concepts and Getting Started | Alfonz Jan Frithz Bakarbessy"><meta name=twitter:description content="Concepts Terraform essentially a tool to manage your infrastructure. Given a set of configurations about how your infrastructure should look like, terraform would help to reconcile the configurations with reality.
  The configurations contain resources that compose your infrastructure expressed in Terraform language (HCL).
Consider the example of the configuration below. When this configuration applied, it would make sure that there are two EC2 instances in your AWS infrastructure using the provided AMI.|"><meta name=twitter:image:src content><meta name=twitter:domain content="https://alfonzjanfrithz.github.io/post/terraform-concepts-and-getting-started/"><title>Terraform: Concepts and Getting Started</title><link rel=canonical href=https://alfonzjanfrithz.github.io/post/terraform-concepts-and-getting-started/><link rel=stylesheet href=https://unpkg.com/tachyons@4.11.1/css/tachyons.min.css><link rel=stylesheet href=https://alfonzjanfrithz.github.io/css/style.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/highlightjs@9.12.0/styles/github-gist.css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body lang=en-us class="sans-serif w-90 w-80-m w-60-ns center mv2 mv5-ns" itemscope itemtype=http://schema.org/Article><span class=b>/</span>
<a href=https://alfonzjanfrithz.github.io/ class="b bb bw1 pb1 no-underline black">Alfonz Jan Frithz Bakarbessy</a>
<span class=b>/</span>
<a href=/post class="b bb bw1 pb1 no-underline black">blog</a><section id=main class=mt5><h1 itemprop=name id=title>Terraform: Concepts and Getting Started</h1><span class="f6 gray">January 10, 2021</span><article itemprop=articleBody id=content class="w-90 lh-copy"><h2 id=concepts>Concepts</h2><p>Terraform essentially a tool to manage your infrastructure.
Given a set of configurations about how your infrastructure should look like, terraform would help to reconcile the configurations with reality.</p><figure><img src=/img/terraform/terraform-general-description.png></figure><p>The configurations contain resources that compose your infrastructure expressed in Terraform language (HCL).</p><p>Consider the example of the configuration below. When this configuration applied, it would make sure that there are two <code>EC2</code> instances in your AWS infrastructure using the provided AMI.</p><pre><code>provider &quot;aws&quot; {
  region = &quot;us-east-1&quot;
}

data &quot;aws_ami&quot; &quot;ubuntu-version-x&quot; {
  # some detailed configuration we will discuss later
}

resource &quot;aws_instance&quot; &quot;front-end&quot; {
  ami           = data.aws_ami.ubuntu-version-x.id
  instance_type = &quot;t3.micro&quot;
}

resource &quot;aws_instance&quot; &quot;back-end&quot; {
  ami           = data.aws_ami.ubuntu-version-x.id
  instance_type = &quot;t3.micro&quot;
}
</code></pre><h3 id=the-problem-it-solves>The Problem it Solves</h3><p>In a simple manner, terraform is solving two things.</p><ul><li><p><strong>Provision the infrastructure (Day 1 Problems)</strong></p><p>Imagine having to manually provision an infrastructure for different environment e.g. Dev, SIT, UAT, PROD. It&rsquo;s going to be slow and painful. Terraform allows you to declare what components you want, check in to source control, applies it for different environment, given different configurations.</p></li><li><p><strong>Maintain the infrastructure (Day 2 Problems)</strong></p><p>As the complexity of the systems increased, the infrastructure will evolve. Terraform has its way that could help us maintain our infrastructure as code less painful.</p></li></ul><h3 id=workflows>Workflows</h3><p>When we work with terraform, there are few commands that we will use this in constant basis to build our config and eventually our infrastructure. Its <code>terraform refresh</code>, <code>terraform plan</code> and <code>terraform apply</code>.</p><h4 id=refresh>Refresh</h4><p>One very important files in terraform is the <code>.tfstate</code>. Terraform is storing its perception of the world currently using what we call <code>state</code>.</p><p>When we perform <code>terraform refresh</code>, terraform will reconcile the current state file, with the real world infrastructure. This could be used to detect any changes from the latest applied state and update the state file as depict in the following figure.<br><br><figure><img src=/img/terraform/terraform-state.png></figure></p><h4 id=plan>Plan</h4><p>When applying resources of our infrastructure, terraform needs to make a way to apply the resources in the correct sequence.</p><p>During <code>terraform plan</code>, terraform performs a refresh, unless explicitly disabled, and then determines what actions are necessary to achieve the desired state specified in the configuration files.
This way, we could see in summary, what terraform will perform when we apply the plan.<br><br><figure><img src=/img/terraform/terraform-plan.png></figure></p><h4 id=apply>Apply</h4><p>The <code>terraform apply</code> command is used to apply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a <code>terraform plan</code> execution plan.</p><p>It will make use the providers to apply the actions and eventually create the entire resources.<br><br><figure><img src=/img/terraform/terraform-apply.png></figure></p><h3 id=module-and-providers>Module and Providers</h3><p>Scaling the workflow is often challenging. Typically, when only you&rsquo;re working with terraform configuration, you will check the plan using <code>terraform plan</code>, applies it using <code>terraform apply</code> and back again modifying your configuration.
This feedback loop happens until you get the desired outcome.</p><figure><img src=/img/terraform/feedback-loop.png></figure><p>This could no longer apply when the project getting bigger. When it involves multiple teams to manage, the workflow could change differently.
For example, the part of the networking could be handled by separate networking team, the same thing possibly happens with the database, where the configuration could be maintained by database administrator.</p><p>Application developer might only want to focus on their application and less focus on the knowledge with all terraform related configurations.</p><p>Therefore, module and providers could come in handy.</p><h4 id=module>Module</h4><p>Modules are self-contained packages of code that allow you to create reusable components by grouping multiple related resources together.
They allow you to view pieces of infrastructure only in terms of the inputs and outputs, without requiring any knowledge of the internal workings.
In other words, you can treat them like little black boxes.</p><p>For instance, you want to create database infrastructure that consist of several resources. Instead of getting to write this repeatedly everytime you need database, you could write a database module. Inside the module, you will describe several resources. You may also set the input as a parameter for those resources as a module parameter and an output for the things that you would like to be outputted to the console, or to other resources later on.</p><p>This way, everytime you need to create database infrastructure, what you need is to use the module and supply any input required by the module.</p><p>This way modules can be used to create lightweight abstractions, so that you can describe your infrastructure in terms of its architecture, rather than directly in terms of physical objects.</p><h4 id=provider>Provider</h4><p>Providers are plugins for Terraform which communicate with Terraform over RPC (remote procedure calls).</p><p>Typically providers will provide you a set of resource that terraform can manage. Example of the provider is <code>aws</code> provider, it gives you a possibility to create resource such as <code>ec2</code> or <code>vpc</code>.</p><h2 id=getting-started>Getting Started</h2><h3 id=installation>Installation</h3><p>With terraform, you will mainly use the <code>cli</code> to perform various terraform operations. Make sure that you have it on your machine.</p><p><strong>Homebrew on OSX</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Tap the repository of hashicorp packages</span>
brew tap hashicorp/tap

<span style=color:#75715e># Install terraform</span>
brew install hashicorp/tap/terraform
</code></pre></div><p><strong>Chocolatey on Windows</strong>
To install chocolatey, follows the instruction <a href=https://docs.chocolatey.org/en-us/choco/setup>here</a></p><pre><code># Install terraform 
choco install terraform
</code></pre><p><strong>Linux</strong>*</p><pre><code># Add GPG Key
curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -

# Add hashicorp repository
sudo apt-add-repository &quot;deb [arch=amd64] https://apt.releases.hashicorp.com $(lsb_release -cs) main&quot;

# Update and Install
sudo apt-get update &amp;&amp; sudo apt-get install terraform
</code></pre><p><strong>Verify your Installation</strong></p><pre><code># Verify the installation
terraform -help
</code></pre><h3 id=example----creating-s3-modules-and-s3-bucket-resources>Example - Creating S3 Modules and S3 Bucket Resources</h3><p>In this example, we are going to see how provider, module and resources looks like. We are going to create those resources in AWS.</p><h2 id=how-do-we-make-use-the-documentations>How do we make use the documentations</h2><h2 id=useful-links>Useful Links</h2></article><span class="f6 gray mv3" title="Lastmod: January 10, 2021. Published at: 2021-01-10."></span></section><footer><div><p class="f6 gray mt6 lh-copy">Â© Alfonz Jan Frithz Bakarbessy<br>Powered by <a href=https://github.com/siegerts/hugo-theme-basic>Hugo Theme Basic</a> by <a href=https://twitter.com/siegerts>@siegerts</a>.</p></div></footer><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>